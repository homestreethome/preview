/**
 * audiowalk
 * @version v0.1.0 - 2014-09-08
 * @link https://github.com/lennart/audiowalk
 * @author Lennart Melzer ()
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
$(document).ready(function(){console.log("this is home.js calling"),window.viewportUnitsBuggyfill.init();var e=function(){return $(window).width()>1200?14:13},o=e(),l=$(".places");$(".place").click(function(e){$(e.currentTarget).toggleClass("place-small").toggleClass("place-large"),$(e.currentTarget).siblings(".place-large").toggleClass("place-large"),t()});var t=function(){l.masonry({columnWidth:".place-small",itemSelector:".place"})};setTimeout(function(){t()},500),t();var a=L.map("map",{minZoom:13,maxZoom:17,fullscreenControl:!0,zoom:o,scrollWheelZoom:!1}).setView([52.2571198321276,10.5145982516365],o);$(window).resize(function(){13==o&&14==e()&&(a.setView([52.2571198321276,10.5145982516365],e()),a.maxZoom(14))}),a.locate({watch:!0}),L.tileLayer("maps/default/tiles/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(a);var n=L.geoJson(null,{style:function(e){return"LineString"===e.geometry.type?(console.log("[map] styling",e),{color:"#168",opacity:1,dashArray:"10,10"}):{}},pointToLayer:function(e,o){console.log("marker",o);var l=L.circleMarker(o,{color:"white",opacity:.8,fillOpacity:.8,fillColor:"red",className:"bnw-marker",dashArray:null}).setRadius(7);return l.bindLabel(e.properties.name,{noHide:!1,direction:"verticalauto",offset:L.point(0,0),className:"bnw-marker-label"})}}),r=function(e,o,l,t){var a=o.lng-e.lng,n=o.lat-e.lat,r=Math.sqrt(Math.pow(a,2)+Math.pow(n,2)),i=l*r,s=t*r;return{sw:{lng:e.lng-s,lat:e.lat-i},ne:{lng:o.lng+s,lat:o.lat+i}}},i="maps/home.gpx",s=omnivore.gpx(i,null,n).on("ready",function(){console.log("labelled route");var e=s.getBounds(),o=r(e.getSouthWest(),e.getNorthEast(),.4,1.5),l=L.latLngBounds(L.latLng(o.sw),L.latLng(o.ne));console.log("[map] padded bounds",l),a.setMaxBounds(l)}).addTo(a)});